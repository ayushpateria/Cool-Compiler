Write-up

**Introduction**

The assignment involved writing a semantic analyser for the COOL language. The whole semantic analysis is done in 3 passes (or phases).

**Structure**

The following files were added/modified:

Semantic.java - The entry point to the semantic analyser is defined here, in the Semantic() function. The AST tree generated by the parser is traversed multiple times, once for each pass. Many SemantNode() functions are defined in this file, each corresponding to a particular AST node types, these are responsible for type checking and type inference.

ClassTable.java - This class mainly does the book keeping for all the classes, objects and methods. It stores the reference to the Graph, object environment and method environment. There's also an installBasicClasses() function which is executed in the constructor, so to populate the environments with the basic classes like Int, Object, etc.

Graph.java - Contains the data structure that is used to define inheritance relation and logic for checking cycles in the graph. The cycles are checked in a top-down manner using the DFS algorithm. Also includes functions like conform, to check if a class is a subtype of another, and lub, to find the least common ancestor of two classes.

**Design**

The whole semantic analysis procedure can be divided in 3 phases:

A class can be defined later than it is used, so in the first pass, we collect all the classes.

Phase 1 -

    Check for the redefinitions of any of the basic classes.
  
    Check for disallowed inheritance from basic classes.
  
    It stores all the classes defined in the classTable.classNameMapper and constructs the Graph with inheritance relationships.
  
    Checks for cycles and reports the errors if any.


Attributes and Methods can be defined in any order, so in the second pass, we collect these.

Phase 2 -

    Mainly responsible for creating the object and method environments for each class, which are stored in the classTable object.
  
    Checks for redefinition of any attributes, methods or formal parameters.
  
    Checks redefinition of any inherited attributes and methods.
  
    Checks if the main class is present.


Phase 3-

    Once we have all verified everything for valid names, we proceed to do the type checks and type inferences.
   
    There are multiple Semant() functions defined, one for each AST node type, which verifies the type of its sub expressions and assigns the correct type to itself as defined in the COOL manual.



Further implementation can be understood by looking at the comments in the source code.